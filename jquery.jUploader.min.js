/**
 * jquery.jUploader.js
 * @version 2.0.1 (01/22/2013)
 * @Requirements: jQuery 1.7 or newer & jQuery UI 1.8 or newer
 * @author Ed <https://github.com/eman1986/jquery.jUploader> 
 * @license http://opensource.org/licenses/mit-license.php MIT License (MIT)
 * CREDIT
 * Concept based off of: http://pixelcone.com/fileuploader/
**/
(function(t){var i=t.ui?t.ui.version||parseFloat("1.5.2"):null,o=jQuery.fn.jquery
t.jUploader={version:"2.0.1"},t.fn.jUploader=function(a){a=t.extend({},{lngOk:"Ok",lngYes:"Yes",lngNo:"No",lngError:"Error",duplicateTitle:"Duplicate Entry",duplicateMsg:"already in pending list.",LoadingCss:"ui-state-highlight",LoadingGfx:"ajax-loader.gif",LoadingMsg:"Uploading File&hellip;",PendingCss:"uploadData",PendingMsg:"Pending&hellip;",FailureCss:"ui-state-error",FailureMsg:"Upload Failed.",buttonUpload:"#fileUpload",buttonClear:"#ClearList",buttonAddMore:"#addMoreFiles",uploadLimit:"5",uploadLimitTitle:"Limit Exceeded",uploadLimitMsg:"You have reached your upload limit.",confirmDeleteTitle:"Delete File?",deleteUrl:"delete.php",confirmDeleteMsg:"Are you sure you want to delete this file?",fileMgrUrl:"filemgr.php"},a),("1.7">o||parseFloat("1.8")>i)&&alert("jUploader requires jquery 1.7 or newer & jQuery UI 1.8 or newer. Please upgrade your copy of jQuery & jQuery UI.")
var l=0,d="attachment",n=[]
t.jUploader.AddtoQueue=function(e){if(a.uploadLimit>l||0==a.uploadLimit){var i=""
if(t("#frmButtons input").removeAttr("disabled"),t(a.buttonClear).attr("disabled",!1),i=""!=t.trim(a.LoadingGfx)?'<img src="'+a.LoadingGfx+'" alt="'+a.LoadingMsg+'" title="'+a.LoadingMsg+'" />':a.LoadingMsg,-1==t.inArray(t(e).val(),n)){var o='<div class="'+a.PendingCss+'" id="jupload_'+l+'_msg" title="'+t(e).val()+'">'+'<div class="close">&nbsp;</div>'+'<span class="fname">'+t(e).val()+"</span>"+'<span class="loader" style="display:none">'+i+"</span>"+'<div class="status">'+a.PendingMsg+"</div></div>"
l++,1==l&&t(a.buttonUpload).attr("disabled",!1),t("#filePendings").append(o),n.push(t(e).val()),r.appendForm(),t(e).hide()}else r.showMsg(a.duplicateTitle,a.duplicateMsg),t(e).val("")}else r.showMsg(a.uploadLimitTitle,a.uploadLimitMsg),t(e).val("")},t(document).on("click",a.buttonUpload,function(){var i
l>0&&(t("#frmButtons input").attr("disabled",!0),t("#frmUpload form").each(function(){e=t(this)
var o="#"+t(e).attr("id"),d=o+"_input",n=t(d).val()
""!=n&&(t(o+"_msg .status").html(a.LoadingMsg),t(o+"_msg").addClass(a.LoadingCss),t(o+"_msg .loader").show(),t(o+"_msg .close").hide(),t(o).submit(),t(o+"_iframe").load(function(){t(o+"_msg .loader").hide()
var d=t.parseJSON(t(this).contents().text())
"success"==d.status?(t(o+"_msg").remove(),r.loadFileManager()):(t(o+"_msg").addClass(a.FailureCss),i=a.FailureMsg),i+="<br />"+d.msg,t(o+"_msg .status").html(i),t(e).remove(),(a.uploadLimit>l||0==a.uploadLimit)&&(t(a.buttonAddMore).show(),t(a.buttonAddMore).removeAttr("disabled")),t(a.buttonClear).removeAttr("disabled")}))}))}),t(document).on("click",".close",function(){var e=t(this).parent().attr("title"),i="#"+t(this).parent().attr("id")
return l-=1,t(i+"_iframe").remove(),t(i).remove(),n.splice(t.inArray(e,n),1),t(i+"_msg").fadeOut("slow",function(){t(this).remove()}),0==l&&t(a.buttonUpload).attr("disabled",!0),!1}),t(document).on("click",".delete",function(t){t.preventDefault(),r.deleteFile(this)}),t(document).on("click",a.buttonClear,function(){t("#filePendings").fadeOut("slow",function(){t("#filePendings").html(""),t("#frmUpload").html(""),t("#filelist").hide(),l=0,n.length=0,r.appendForm(),t("#frmButtons input").attr("disabled",!0),t(a.buttonFileMgr).removeAttr("disabled"),t(a.buttonAddMore).hide(),t(this).show()})}),t(document).on("click",a.buttonAddMore,function(){t("#filePendings").fadeOut("slow",function(){t("#filePendings").html(""),t("#frmUpload").html(""),r.appendForm(),t("#frmButtons input").attr("disabled",!0),t(a.buttonFileMgr).removeAttr("disabled"),t(a.buttonAddMore).hide(),t(this).show()})})
var r={init:function(e){var i=t(e).parents("form")
r.formAction=t(i).attr("action"),t(i).before('     	            <div id="frmUpload"></div> 					<div id="filePendings"></div> 					<div id="frmButtons"></div> 					<div id="jupload_juiDlg"></div> 				'),t(a.buttonUpload+","+a.buttonClear+","+a.buttonAddMore).appendTo("#frmButtons"),t(a.buttonClear).attr("disabled",!0),t(a.buttonUpload).attr("disabled",!0),t(a.buttonAddMore).hide(),""!=t(e).attr("name")&&(d=t(e).attr("name")),t(i).hide(),t("#frmUpload").html(""),this.appendForm()},appendForm:function(){var e="jupload_"+l,i="jupload_"+l+"_iframe",o="jupload_"+l+"_input",a='<form method="post" id="'+e+'" action="'+r.formAction+'" enctype="multipart/form-data" target="'+i+'">'+'<input type="file" name="'+d+'" id="'+o+'" class="jupload" onchange="$.jUploader.AddtoQueue(this);" />'+"</form>"+'<iframe id="'+i+'" name="'+i+'" src="about:blank" style="display:none"></iframe>'
t("#frmUpload").append(a)},showMsg:function(e,i){var o={}
o[a.lngOk]=function(){t(this).dialog("close")},t("#jupload_juiDlg").text(i),t("#jupload_juiDlg").dialog({modal:!0,width:"500",height:"125",title:e,closeOnEscape:!0,buttons:o})},loadFileManager:function(){t.ajax({method:"get",url:a.fileMgrUrl,success:function(e){t("#filelist").show(),t("#filelist").html(e)},error:function(t){r.showMsg(a.lngError,t.status+" "+t.statusText)}})},deleteFile:function(e){var i={}
i[a.lngYes]=function(){t(this).dialog("close"),t(e).load(a.deleteUrl,{filename:t(e).attr("id")},function(i,o,d){"error"==o?r.showMsg(a.lngError,d.status+" "+d.statusText):(l-=1,n.splice(t.inArray(t(e).attr("id"),n),1),r.loadFileManager(),(a.uploadLimit>l||0==a.uploadLimit)&&(t(a.buttonAddMore).show(),t(a.buttonAddMore).removeAttr("disabled")),0==l&&(t("#filelist").hide(),l=0,n.length=0,r.appendForm(),t(a.buttonClear).attr("disabled",!0),t(a.buttonUpload).attr("disabled",!0),t(a.buttonAddMore).hide()))})},i[a.lngNo]=function(){t(this).dialog("close")},t("#jupload_juiDlg").text(a.confirmDeleteMsg),t("#jupload_juiDlg").dialog({modal:!0,width:"300",height:"125",title:a.confirmDeleteTitle,closeOnEscape:!0,buttons:i})}}
return r.init(this),this}})(jQuery)