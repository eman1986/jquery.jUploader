/**
 * jquery.jUploader.min.js-
 * @version 2.0 (06/26/2012)
 * @Requirements: jQuery 1.7 or newer & jQuery UI 1.8 or newer
 * @license http://opensource.org/licenses/mit-license.php MIT License (MIT)
 * CREDIT
 * Concept based off of: http://pixelcone.com/fileuploader/
**/
(function(t){var n=t.ui?t.ui.version||"1.5.2":null,r=jQuery.fn.jquery;t.jUploader={version:"2.0"},t.fn.jUploader=function(i){i=t.extend({},{lngOk:"Ok",lngYes:"Yes",lngNo:"No",lngError:"Error",duplicateTitle:"Duplicate Entry",duplicateMsg:"already in pending list.",LoadingCss:"ui-state-highlight",LoadingGfx:"ajax-loader.gif",LoadingMsg:"Uploading File&hellip;",PendingCss:"uploadData",PendingMsg:"Pending&hellip;",FailureCss:"ui-state-error",FailureMsg:"Upload Failed.",buttonUpload:"#fileUpload",buttonClear:"#ClearList",buttonAddMore:"#addMoreFiles",uploadLimit:"5",uploadLimitTitle:"Limit Exceeded",uploadLimitMsg:"You have reached your upload limit.",confirmDeleteTitle:"Delete File?",deleteUrl:"delete.php",confirmDeleteMsg:"Are you sure you want to delete this file?",fileMgrUrl:"filemgr.php"},i),(r<"1.7"||n<"1.8")&&alert("jUploader requires jquery 1.7 or newer & jQuery UI 1.8 or newer. Please upgrade your copy of jQuery & jQuery UI.");var s=0,o="attachment",u=new Array;t.jUploader.AddtoQueue=function(e){if(s<i.uploadLimit||i.uploadLimit==0){var n="";t("#frmButtons input").removeAttr("disabled"),t(i.buttonClear).attr("disabled",!1),t.trim(i.LoadingGfx)!=""?n='<img src="'+i.LoadingGfx+'" alt="'+i.LoadingMsg+'" title="'+i.LoadingMsg+'" />':n=i.LoadingMsg;if(t.inArray(t(e).val(),u)==-1){var r='<div class="'+i.PendingCss+'" id="jupload_'+s+'_msg" title="'+t(e).val()+'">'+'<div class="close">&nbsp;</div>'+'<span class="fname">'+t(e).val()+"</span>"+'<span class="loader" style="display:none">'+n+"</span>"+'<div class="status">'+i.PendingMsg+"</div></div>";s++,s==1&&t(i.buttonUpload).attr("disabled",!1),t("#filePendings").append(r),u.push(t(e).val()),a.appendForm(),t(e).hide()}else a.showMsg(i.duplicateTitle,i.duplicateMsg),t(e).val("")}else a.showMsg(i.uploadLimitTitle,i.uploadLimitMsg),t(e).val("")},t(document).on("click",i.buttonUpload,function(){var n;s>0&&(t("#frmButtons input").attr("disabled",!0),t("#frmUpload form").each(function(){e=t(this);var r="#"+t(e).attr("id"),o=r+"_input",u=t(o).val();u!=""&&(t(r+"_msg .status").html(i.LoadingMsg),t(r+"_msg").addClass(i.LoadingCss),t(r+"_msg .loader").show(),t(r+"_msg .close").hide(),t(r).submit(),t(r+"_iframe").load(function(){t(r+"_msg .loader").hide();var o=t.parseJSON(t(this).contents().text());o.status=="success"?(t(r+"_msg").remove(),a.loadFileManager()):(t(r+"_msg").addClass(i.FailureCss),n=i.FailureMsg),n+="<br />"+o.msg,t(r+"_msg .status").html(n),t(e).remove();if(s<i.uploadLimit||i.uploadLimit==0)t(i.buttonAddMore).show(),t(i.buttonAddMore).removeAttr("disabled");t(i.buttonClear).removeAttr("disabled")}))}))}),t(document).on("click",".close",function(){var e=t(this).parent().attr("title"),n="#"+t(this).parent().attr("id");return s-=1,t(n+"_iframe").remove(),t(n).remove(),u.splice(t.inArray(e,u),1),t(n+"_msg").fadeOut("slow",function(){t(this).remove()}),s==0&&t(i.buttonUpload).attr("disabled",!0),!1}),t(document).on("click",".delete",function(e){e.preventDefault(),a.deleteFile(this)}),t(document).on("click",i.buttonClear,function(){t("#filePendings").fadeOut("slow",function(){t("#filePendings").html(""),t("#frmUpload").html(""),t("#filelist").hide(),s=0,u.length=0,a.appendForm(),t("#frmButtons input").attr("disabled",!0),t(i.buttonFileMgr).removeAttr("disabled"),t(i.buttonAddMore).hide(),t(this).show()})}),t(document).on("click",i.buttonAddMore,function(){t("#filePendings").fadeOut("slow",function(){t("#filePendings").html(""),t("#frmUpload").html(""),a.appendForm(),t("#frmButtons input").attr("disabled",!0),t(i.buttonFileMgr).removeAttr("disabled"),t(i.buttonAddMore).hide(),t(this).show()})});var a={init:function(e){var n=t(e).parents("form");a.formAction=t(n).attr("action"),t(n).before('     	            <div id="frmUpload"></div> 					<div id="filePendings"></div> 					<div id="frmButtons"></div> 					<div id="jupload_juiDlg"></div> 				'),t(i.buttonUpload+","+i.buttonClear+","+i.buttonAddMore).appendTo("#frmButtons"),t(i.buttonClear).attr("disabled",!0),t(i.buttonUpload).attr("disabled",!0),t(i.buttonAddMore).hide(),t(e).attr("name")!=""&&(o=t(e).attr("name")),t(n).hide(),t("#frmUpload").html(""),this.appendForm()},appendForm:function(){var e="jupload_"+s,n="jupload_"+s+"_iframe",r="jupload_"+s+"_input",i='<form method="post" id="'+e+'" action="'+a.formAction+'" enctype="multipart/form-data" target="'+n+'">'+'<input type="file" name="'+o+'" id="'+r+'" class="jupload" onchange="$.jUploader.AddtoQueue(this);" />'+"</form>"+'<iframe id="'+n+'" name="'+n+'" src="about:blank" style="display:none"></iframe>';t("#frmUpload").append(i)},showMsg:function(e,n){var r={};r[i.lngOk]=function(){t(this).dialog("close")},t("#jupload_juiDlg").text(n),t("#jupload_juiDlg").dialog({modal:!0,width:"500",height:"125",title:e,closeOnEscape:!0,buttons:r})},loadFileManager:function(){t.ajax({method:"get",url:i.fileMgrUrl,success:function(e){t("#filelist").show(),t("#filelist").html(e)},error:function(e,t,n){a.showMsg(i.lngError,e.status+" "+e.statusText)}})},deleteFile:function(e){var n={};n[i.lngYes]=function(){t(this).dialog("close"),t(e).load(i.deleteUrl,{filename:t(e).attr("id")},function(n,r,o){if(r=="error")a.showMsg(i.lngError,o.status+" "+o.statusText);else{s-=1,u.splice(t.inArray(t(e).attr("id"),u),1),a.loadFileManager();if(s<i.uploadLimit||i.uploadLimit==0)t(i.buttonAddMore).show(),t(i.buttonAddMore).removeAttr("disabled");s==0&&(t("#filelist").hide(),s=0,u.length=0,a.appendForm(),t(i.buttonClear).attr("disabled",!0),t(i.buttonUpload).attr("disabled",!0),t(i.buttonAddMore).hide())}})},n[i.lngNo]=function(){t(this).dialog("close")},t("#jupload_juiDlg").text(i.confirmDeleteMsg),t("#jupload_juiDlg").dialog({modal:!0,width:"300",height:"125",title:i.confirmDeleteTitle,closeOnEscape:!0,buttons:n})}};return a.init(this),this}})(jQuery)